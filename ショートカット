import os
import shutil
import winshell

def create_shortcut(source_path, target_folder):
    # ショートカットを作成するフォルダが存在しない場合は作成する
    if not os.path.exists(target_folder):
        os.makedirs(target_folder)
    
    # ショートカットを作成する
    target_path = os.path.join(target_folder, os.path.basename(source_path) + ".lnk")
    winshell.CreateShortcut(
        Path=target_path,
        Target=source_path,
        Description="Shortcut to {}".format(os.path.basename(source_path))
    )

# デスクトップのPythonファイルを "Process" フォルダに移動
source_folder = os.path.join(os.path.expanduser("~"), "Desktop")
target_folder = os.path.join(source_folder, "Process")

if not os.path.exists(target_folder):
    os.makedirs(target_folder)

for filename in os.listdir(source_folder):
    if filename.endswith(".py"):
        source_path = os.path.join(source_folder, filename)
        shutil.move(source_path, target_folder)

# "Process" フォルダに移動したPythonファイルのショートカットをデスクトップに作成
for filename in os.listdir(target_folder):
    if filename.endswith(".py"):
        source_path = os.path.join(target_folder, filename)
        create_shortcut(source_path, source_folder)