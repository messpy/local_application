@echo off
setlocal enabledelayedexpansion

rem デスクトップのPythonファイルをダウンロードフォルダに移動
move %userprofile%\Desktop\*.py %userprofile%\Downloads

rem ダウンロードフォルダに移動したPythonファイルのショートカットをデスクトップに作成
cd %userprofile%\Downloads
for %%f in (*.py) do (
    set "target=%%~nf.lnk"
    set "link=%userprofile%\Desktop\!target!"
    set "target=!cd!\%%f"
    echo Creating shortcut for !target! to !link!
    powershell -Command "$WScriptShell = New-Object -ComObject WScript.Shell; $Shortcut = $WScriptShell.CreateShortcut('!link!'); $Shortcut.TargetPath = '!target!'; $Shortcut.Save()"
)