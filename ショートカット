@echo off
setlocal enabledelayedexpansion

rem デスクトップのPythonファイルを "Process" フォルダに移動
move "%userprofile%\Desktop\*.py" "%userprofile%\Desktop\Process"

rem "Process" フォルダに移動したPythonファイルのショートカットをデスクトップに作成
cd "%userprofile%\Desktop\Process"
for %%f in (*.py) do (
    set "target=%%~nf"
    set "link=%userprofile%\Desktop\!target!.lnk"
    set "target=!cd!\%%f"
    echo Creating shortcut for !target! to !link!
    powershell -Command "$WScriptShell = New-Object -ComObject WScript.Shell; $Shortcut = $WScriptShell.CreateShortcut('!link!'); $Shortcut.TargetPath = '!target!'; $Shortcut.Save()"
)