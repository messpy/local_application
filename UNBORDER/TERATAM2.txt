import subprocess
import time

def start_teraterm(port):
    # TERATERMの実行
    process = subprocess.Popen(['teraterm', '/C=1', '/BAUD=115200', f'/P={port}'], stdin=subprocess.PIPE, stdout=subprocess.PIPE, text=True)

    # ポートがオープンするまで待機
    time.sleep(5)  # 適切な待機時間を設定

    # コマンドを送信して結果を取得
    result = send_command(process, 'ls')
    print(result)

def send_command(process, command):
    # コマンドの送信
    process.stdin.write(f"{command}\n")
    process.stdin.flush()

    # 結果の取得
    result = process.stdout.read()
    return result

if __name__ == "__main__":
    port_number = "COM1"  # 利用するシリアルポートを指定
    start_teraterm(port_number)